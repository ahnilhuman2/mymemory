<!DOCTYPE html>
<html xmlns:th="http//www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default_layout}">

<div layout:fragment="content">
    <h1>로그인</h1>
    <label for="id">아이디:</label>
    <input type="text" id="id" name="username">
    <label for="password">비밀번호:</label>
    <input type="password" id="password" name="password">
    <input type="button" value="로그인" onclick="login()">
</div>

<script layout:fragment="script">
    function login() {
        $.ajax({
            contentType: 'application/json',
            url: `/api/login`,
            type:"POST",
            dataType: 'json',
            headers: { 'X-AUTH-TOKEN': localStorage.getItem("token") },
            data: JSON.stringify({
                "username": $("#id").val(),
                "password": $("#password").val()
            }),
            success : function(data) {
                if (data.status == 200) {
                    localStorage.setItem("token" , data.token);
                    location.href = `/home`;
                } else alert(data.message);
            }
        })
    }
</script>

</html>